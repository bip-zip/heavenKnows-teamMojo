{% block styles %}
<style>
    /* CRITICAL: Hide ALL Google Translate UI elements */
    .goog-te-banner-frame.skiptranslate {
        display: none !important;
    }


    .goog-te-banner-frame {
        display: none !important;
    }


    .skiptranslate {
        display: none !important;
    }


    #goog-gt-tt,
    .goog-gt-tt,
    .goog-te-balloon-frame,
    .goog-text-highlight {
        display: none !important;
    }


    .goog-te-combo {
        display: none !important;
    }


    #google_translate_element {
        display: none !important;
    }


    body {
        top: 0 !important;
        position: static !important;
    }


    /* Your navbar visual tweaks (optional) */
    /* .gradient-btn {
       background: linear-gradient(90deg, #fb923c, #06b6d4);
   } */
</style>
{% endblock styles %}




<nav id="navbar" class="sticky top-0 z-50 transition-all duration-300 bg-white/60 backdrop-blur-md">
    <div class="w-full md:px-16 px-4">
        <div class="flex items-center justify-between h-16">


            <!-- Logo -->
            <a href="/" class="flex items-center space-x-2 group">
                <div class="relative">
                    <i
                        class="fas fa-mountain text-orange-600 text-2xl group-hover:text-orange-700 transition-colors"></i>
                    <div class="absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full animate-pulse"></div>
                </div>
                <span class="text-2xl font-bold text-neutral-900">
                    Heaven<span class="text-orange-600">Knows</span>
                </span>
            </a>


            <!-- Desktop Navigation -->
            <div class="hidden md:flex items-center space-x-1">
                <a href="{% url 'explore:index' %}"
                    class="nav-link px-4 py-2 rounded-lg text-neutral-700 hover:bg-orange-50 hover:text-orange-600 transition-all duration-200">Explore</a>
                <a href="/destinations"
                    class="nav-link px-4 py-2 rounded-lg text-neutral-700 hover:bg-orange-50 hover:text-orange-600 transition-all duration-200">Destinations</a>
                <a href="/packages"
                    class="nav-link px-4 py-2 rounded-lg text-neutral-700 hover:bg-orange-50 hover:text-orange-600 transition-all duration-200">Packages</a>
                <a href="{% url 'businesses:local_to_global' %}"
                    class="nav-link px-4 py-2 rounded-lg text-neutral-700 hover:bg-orange-50 hover:text-orange-600 transition-all duration-200">Local
                    to Global</a>
            </div>


            <div class="flex items-center gap-x-2">
                {% if user.is_authenticated %}
                <div class="hidden md:flex items-center">
                    <a href="{% url 'accounts:profile' %}"
                        class="flex items-center space-x-2 px-4 py-2 gradient-btn text-white rounded-full shadow-lg hover:shadow-xl transition-colors ease-in-out duration-300">
                        <i class="fas fa-user text-sm"></i>
                        <span>Profile</span>
                    </a>
                </div>
                {% else %}
                <div class="hidden md:flex items-center">
                    <a href="{% url 'accounts:login'%}"
                        class="flex items-center space-x-2 px-4 py-2 gradient-btn text-white rounded-full shadow-lg hover:shadow-xl transition-colors ease-in-out duration-300">
                        <i class="fas fa-user text-sm"></i> <span>Login</span> </a>
                </div>
                {% endif %}


                <!-- Google Translate Dropdown -->
                <div class="relative inline-block text-left ml-4">
                    <select id="languageSelect"
                        class="bg-white/70 backdrop-blur-md border border-neutral-300 text-neutral-700 rounded-full pl-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-orange-400 cursor-pointer transition-all hover:border-orange-400">
                        <!-- <option value="">Language</option> -->
                        <option value="en">English</option>
                        <option value="ne">नेपाली</option>
                    </select>
                </div>


                <!-- Mobile Menu Button -->
                <button id="mobile-menu-btn"
                    class="md:hidden p-2 rounded-lg text-neutral-700 hover:bg-orange-50 transition-colors">
                    <i id="menu-icon" class="fas fa-bars text-xl"></i>
                </button>
            </div>


            <!-- Hidden Google Translate Element required for the library (kept off-screen) -->
            <div id="google_translate_element" style="position:absolute; left:-9999px; visibility:hidden;"></div>
        </div>


        <!-- Mobile Navigation -->
        <div id="mobile-menu"
            class="md:hidden max-h-0 opacity-0 overflow-hidden transition-all duration-300 ease-in-out bg-white/95 backdrop-blur-lg">
            <div class="px-4 pt-2 pb-4 space-y-2">
                <a href="/explore"
                    class="block px-4 py-3 rounded-lg text-neutral-700 hover:bg-orange-50 transition-all mobile-nav-link">Explore</a>
                <a href="{% url 'destinations:list' %}"
                    class="block px-4 py-3 rounded-lg text-neutral-700 hover:bg-orange-50 transition-all mobile-nav-link">Destinations</a>
                <a href="{% url 'packages:list' %}"
                    class="block px-4 py-3 rounded-lg text-neutral-700 hover:bg-orange-50 transition-all mobile-nav-link">Packages</a>
                <a href="/local-business"
                    class="block px-4 py-3 rounded-lg text-neutral-700 hover:bg-orange-50 transition-all mobile-nav-link">Local
                    Business</a>
                {% if user.is_authenticated %}
                <a href="{% url 'accounts:profile' %}"
                    class="block px-4 py-3 gradient-btn text-white rounded-lg text-center shadow-md">Profile</a>
                {% else %}
                <a href="{% url 'accounts:login' %}"
                    class="block px-4 py-3 gradient-btn text-white rounded-lg text-center shadow-md">Login /
                    Register</a>
                {% endif %}
            </div>
        </div>
    </div>
</nav>




{% block scripts %}


<!-- Google Translate library (keeps element hidden) -->
<script type="text/javascript">
    function googleTranslateElementInit() {
        new google.translate.TranslateElement({
            pageLanguage: 'en',
            includedLanguages: 'en,ne',
            autoDisplay: false
        }, 'google_translate_element');
    }
</script>
<script type="text/javascript"
    src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>


<script>
    // Helper: set cookie (handles localhost vs domain)
    function setCookie(name, value, days) {
        let expires = "";
        if (days) {
            const date = new Date();
            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
            expires = "; expires=" + date.toUTCString();
        }
        const hostname = location.hostname;
        // If localhost or 127.0.0.1 set cookie without domain
        if (hostname === "localhost" || hostname === "127.0.0.1") {
            document.cookie = name + "=" + value + expires + "; path=/";
        } else {
            // Try to set for current domain and dot-prefixed domain
            document.cookie = name + "=" + value + expires + "; path=/; domain=" + hostname;
            try {
                document.cookie = name + "=" + value + expires + "; path=/; domain=." + hostname;
            } catch (e) { /* ignore domain errors */ }
        }
    }


    function getCookie(name) {
        const v = document.cookie.match('(^|;)\\s*' + name + '\\s*=\\s*([^;]+)');
        return v ? v.pop() : '';
    }


    // Apply language by writing googtrans cookie then reloading
    function applyLanguage(targetLang) {
        if (!targetLang) {
            // Clear translation
            setCookie('googtrans', '', -1);
            localStorage.removeItem('googtrans');
            location.reload();
            return;
        }
        const source = 'en'; // your page default language
        const cookieValue = '/' + source + '/' + targetLang;
        setCookie('googtrans', cookieValue, 365);
        localStorage.setItem('googtrans', cookieValue);
        // reload to let Google read cookie and translate
        setTimeout(() => location.reload(), 200);
    }


    document.addEventListener('DOMContentLoaded', function () {
        const languageSelect = document.getElementById('languageSelect');
        // Initialize select from cookie/localStorage if set
        const stored = localStorage.getItem('googtrans') || getCookie('googtrans');
        if (stored && stored.startsWith('/en/')) {
            const lang = stored.split('/')[2];
            if (lang === 'ne' || lang === 'en') {
                languageSelect.value = lang;
            }
        } else {
            languageSelect.value = ''; // default
        }


        // Change handler
        languageSelect.addEventListener('change', function () {
            const val = this.value;
            if (!val) {
                applyLanguage('');
            } else {
                applyLanguage(val);
            }
        });


        // Mobile menu controls (safe guard if elements exist)
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        const menuIcon = document.getElementById('menu-icon');
        if (mobileMenuBtn) {
            let open = false;
            mobileMenuBtn.addEventListener('click', () => {
                open = !open;
                if (open) {
                    mobileMenu.classList.remove('max-h-0', 'opacity-0');
                    mobileMenu.classList.add('max-h-96', 'opacity-100');
                    menuIcon.classList.remove('fa-bars'); menuIcon.classList.add('fa-xmark');
                } else {
                    mobileMenu.classList.remove('max-h-96', 'opacity-100');
                    mobileMenu.classList.add('max-h-0', 'opacity-0');
                    menuIcon.classList.remove('fa-xmark'); menuIcon.classList.add('fa-bars');
                }
            });
        }


        // Remove Google top banner if it appears later
        setTimeout(() => {
            const banner = document.querySelector('.goog-te-banner-frame');
            if (banner) banner.remove();
            document.body.style.top = '0';
        }, 800);
    });
</script>


{% endblock scripts %}